<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UPSC Journey Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            text-align: center;
        }

        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .date-display {
            color: #666;
            font-size: 1.2em;
        }

        .section {
            background: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            color: white;
            transition: transform 0.3s;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 3s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 0.8; }
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
            position: relative;
            z-index: 1;
        }

        .stat-label {
            font-size: 1.1em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .target-indicator {
            font-size: 0.9em;
            margin-top: 5px;
            opacity: 0.8;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            margin: 5px;
            font-weight: 600;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .delete-btn, .edit-btn {
            background: #ff4757;
            padding: 8px 16px;
            font-size: 14px;
        }

        .edit-btn {
            background: #ffa502;
        }

        .delete-btn:hover {
            background: #ee5a6f;
        }

        .edit-btn:hover {
            background: #ff7f00;
        }

        .timer-display {
            font-size: 4em;
            text-align: center;
            color: #667eea;
            margin: 30px 0;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .timer-controls {
            text-align: center;
            margin: 20px 0;
        }

        .study-log {
            background: #f9f9f9;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 5px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .study-log:hover {
            background: #f0f0f0;
            transform: translateX(5px);
        }

        .routine-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f9f9f9;
            margin: 10px 0;
            border-radius: 10px;
            gap: 15px;
            transition: all 0.3s;
        }

        .routine-item:hover {
            background: #f0f0f0;
        }

        .routine-item input[type="checkbox"] {
            width: 24px;
            height: 24px;
            cursor: pointer;
            accent-color: #667eea;
        }

        .countdown-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 15px 0;
            text-align: center;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .countdown-number {
            font-size: 3.5em;
            font-weight: bold;
            margin: 15px 0;
        }

        .progress-bar {
            width: 100%;
            height: 35px;
            background: #e0e0e0;
            border-radius: 20px;
            overflow: hidden;
            margin: 15px 0;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 16px;
        }

        .todo-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f9f9f9;
            margin: 10px 0;
            border-radius: 10px;
            gap: 15px;
            transition: all 0.3s;
        }

        .todo-item:hover {
            background: #f0f0f0;
        }

        .todo-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #667eea;
        }

        .journal-entry {
            background: #f9f9f9;
            padding: 20px;
            margin: 15px 0;
            border-radius: 12px;
            border-left: 5px solid #667eea;
            transition: all 0.3s;
        }

        .journal-entry:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .date-header {
            color: #667eea;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .glass-counter {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 20px 0;
            justify-content: center;
        }

        .glass {
            width: 50px;
            height: 70px;
            background: #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .glass.filled {
            background: linear-gradient(180deg, #667eea, #4fc3f7);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .glass:hover {
            transform: scale(1.15) rotate(5deg);
        }

        .heatmap-container {
            margin: 30px 0;
        }

        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin: 20px 0;
        }

        .heatmap-day {
            aspect-ratio: 1;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: white;
            font-weight: bold;
        }

        .heatmap-day:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .heatmap-level-0 { background: #ebedf0; color: #666; }
        .heatmap-level-1 { background: #c6e48b; }
        .heatmap-level-2 { background: #7bc96f; }
        .heatmap-level-3 { background: #239a3b; }
        .heatmap-level-4 { background: #196127; }

        .heatmap-legend {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .legend-box {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .streak-display {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .streak-number {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }

        .performance-badge {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.2em;
            margin: 10px 0;
        }

        .badge-excellent { background: #10ac84; color: white; }
        .badge-good { background: #48dbfb; color: white; }
        .badge-average { background: #feca57; color: #333; }
        .badge-poor { background: #ff6b6b; color: white; }

        .input-group {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
        }

        .input-group input {
            flex: 1;
            min-width: 150px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s;
        }

        .modal-content {
            background: white;
            margin: 10% auto;
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close {
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #999;
        }

        .close:hover {
            color: #333;
        }

        .weekday-labels {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 10px;
            text-align: center;
            font-weight: bold;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ UPSC Journey Tracker</h1>
            <div class="date-display" id="currentDate"></div>
        </div>

        <!-- Today's Dashboard -->
        <div class="section">
            <h2>üìä Today's Productivity Dashboard</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="todayStudyTime">0h 0m</div>
                    <div class="stat-label">Study Time</div>
                    <div class="target-indicator">Target: 8 hours</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="todaySleep">0h</div>
                    <div class="stat-label">Sleep</div>
                    <div class="target-indicator">Target: 8 hours</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="todayWater">0</div>
                    <div class="stat-label">Water (Glasses)</div>
                    <div class="target-indicator">Target: 8 glasses</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="routineCompletion">0%</div>
                    <div class="stat-label">Routine Completed</div>
                    <div class="target-indicator">Target: 100%</div>
                </div>
            </div>
        </div>

        <!-- Monthly Overview -->
        <div class="section">
            <h2>üìÖ Monthly Overview</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="monthlyTotalHours">0h</div>
                    <div class="stat-label">Total Study Hours</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="monthlyAverage">0h</div>
                    <div class="stat-label">Average per Day</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="monthlyAttendance">0</div>
                    <div class="stat-label">Days Studied</div>
                </div>
            </div>

            <div class="streak-display">
                <div>üî• Current Streak</div>
                <div class="streak-number" id="streakCount">0</div>
                <div>consecutive days</div>
            </div>

            <div style="text-align: center; margin: 20px 0;">
                <div id="performanceBadge"></div>
            </div>

            <div class="heatmap-container">
                <h3 style="color: #667eea; margin-bottom: 15px;">Study Heatmap - Current Month</h3>
                <div class="weekday-labels">
                    <div>Sun</div>
                    <div>Mon</div>
                    <div>Tue</div>
                    <div>Wed</div>
                    <div>Thu</div>
                    <div>Fri</div>
                    <div>Sat</div>
                </div>
                <div class="heatmap-grid" id="heatmapGrid"></div>
                <div class="heatmap-legend">
                    <span>Less</span>
                    <div class="legend-item">
                        <div class="legend-box heatmap-level-0"></div>
                        <span>0h</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box heatmap-level-1"></div>
                        <span>1-3h</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box heatmap-level-2"></div>
                        <span>4-6h</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box heatmap-level-3"></div>
                        <span>7-9h</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box heatmap-level-4"></div>
                        <span>10h+</span>
                    </div>
                    <span>More</span>
                </div>
            </div>
        </div>

        <!-- Study Timer -->
        <div class="section">
            <h2>‚è±Ô∏è Study Timer</h2>
            <div class="input-group">
                <select id="subjectSelect">
                    <option value="">Select Subject</option>
                </select>
                <input type="text" id="newSubject" placeholder="Add new subject">
                <button onclick="addSubject()">Add Subject</button>
            </div>
            
            <div class="timer-display" id="timerDisplay">00:00:00</div>
            
            <div class="timer-controls">
                <button onclick="startTimer()" id="startBtn">‚ñ∂ Start</button>
                <button onclick="pauseTimer()" id="pauseBtn">‚è∏ Pause</button>
                <button onclick="stopTimer()" id="stopBtn">‚èπ Stop & Save</button>
            </div>

            <h3 style="color: #667eea; margin-top: 30px;">Today's Study Sessions</h3>
            <div id="studyLog"></div>

            <h3 style="color: #667eea; margin-top: 30px;">Subject-wise Total Study Time</h3>
            <div id="subjectTotals"></div>
        </div>

        <!-- Health Tracker -->
        <div class="section">
            <h2>üí™ Health Tracker</h2>
            
            <h3 style="color: #667eea;">Sleep Tracker</h3>
            <div class="input-group">
                <input type="number" id="sleepHours" min="0" max="24" step="0.5" placeholder="Hours of sleep">
                <button onclick="saveSleep()">üí§ Save Sleep</button>
            </div>

            <h3 style="color: #667eea; margin-top: 30px;">Water Intake</h3>
            <p style="margin: 10px 0; color: #666;">Click glasses to track your water intake</p>
            <div class="glass-counter" id="waterGlasses"></div>
            <p style="text-align: center; font-size: 1.2em; color: #667eea;"><strong>Today: <span id="waterCount">0</span> / 8 glasses</strong></p>
        </div>

        <!-- Daily Journal -->
        <div class="section">
            <h2>üìù Daily Journal</h2>
            <textarea id="journalText" rows="8" placeholder="Write about your day, your learnings, challenges, and achievements..."></textarea>
            <button onclick="saveJournal()">üíæ Save Entry</button>

            <h3 style="color: #667eea; margin-top: 30px;">Previous Entries</h3>
            <div id="journalEntries"></div>
        </div>

        <!-- Routine Tracker -->
        <div class="section">
            <h2>üìã Daily Routine Tracker</h2>
            
            <h3 style="color: #667eea;">Create/Edit Routine</h3>
            <div class="input-group">
                <input type="time" id="routineTime">
                <input type="text" id="routineActivity" placeholder="Activity">
                <button onclick="addRoutineItem()">‚ûï Add to Routine</button>
            </div>

            <h3 style="color: #667eea; margin-top: 30px;">Today's Routine</h3>
            <div id="routineList"></div>
        </div>

        <!-- To-Do List -->
        <div class="section">
            <h2>‚úÖ Today's To-Do List</h2>
            <div class="input-group">
                <input type="text" id="todoInput" placeholder="Add a task...">
                <button onclick="addTodo()">‚ûï Add Task</button>
            </div>
            <div id="todoList"></div>
        </div>

        <!-- Event Countdown -->
        <div class="section">
            <h2>üéØ Important Events Countdown</h2>
            <div class="input-group">
                <input type="text" id="eventName" placeholder="Event name (e.g., UPSC Prelims)">
                <input type="date" id="eventDate">
                <button onclick="addEvent()">‚ûï Add Event</button>
            </div>
            <div id="eventList"></div>
        </div>

        <!-- Syllabus Progress -->
        <div class="section">
            <h2>üìö Syllabus Progress Tracker</h2>
            <div class="input-group">
                <input type="text" id="syllabusSubject" placeholder="Subject">
                <input type="text" id="syllabusTopic" placeholder="Topic">
                <input type="number" id="syllabusTotal" placeholder="Total units" min="1">
                <button onclick="addSyllabusTopic()">‚ûï Add Topic</button>
            </div>
            <div id="syllabusList"></div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditModal()">&times;</span>
            <h2 style="color: #667eea;">Edit Study Session</h2>
            <select id="editSubject"></select>
            <input type="number" id="editHours" placeholder="Hours" min="0">
            <input type="number" id="editMinutes" placeholder="Minutes" min="0" max="59">
            <button onclick="saveEdit()">üíæ Save Changes</button>
        </div>
    </div>

    <script>
        let data = {
            subjects: ['History', 'Geography', 'Polity', 'Economics', 'Ethics', 'CSAT'],
            studySessions: [],
            journals: [],
            routine: [],
            todos: [],
            events: [],
            syllabus: [],
            health: {
                sleep: {},
                water: {},
                routine: {}
            }
        };

        let timerInterval = null;
        let timerSeconds = 0;
        let timerRunning = false;
        let editingSessionIndex = -1;

        function loadData() {
            const saved = localStorage.getItem('upscTrackerData');
            if (saved) {
                data = JSON.parse(saved);
            }
            initializeApp();
        }

        function saveData() {
            localStorage.setItem('upscTrackerData', JSON.stringify(data));
        }

        function initializeApp() {
            updateCurrentDate();
            updateSubjectSelect();
            updateDashboard();
            updateStudyLog();
            updateJournalEntries();
            updateRoutineList();
            updateTodoList();
            updateEventList();
            updateSyllabusList();
            updateWaterGlasses();
            loadTodaySleep();
            updateMonthlyOverview();
        }

        function updateCurrentDate() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-US', options);
        }

        function startTimer() {
            const subject = document.getElementById('subjectSelect').value;
            if (!timerRunning && subject) {
                timerRunning = true;
                document.getElementById('startBtn').disabled = true;
                timerInterval = setInterval(() => {
                    timerSeconds++;
                    updateTimerDisplay();
                }, 1000);
            } else if (!subject) {
                alert('Please select a subject first!');
            }
        }

        function pauseTimer() {
            timerRunning = false;
            clearInterval(timerInterval);
            document.getElementById('startBtn').disabled = false;
        }

        function stopTimer() {
            if (timerSeconds > 0) {
                const subject = document.getElementById('subjectSelect').value;
                const session = {
                    subject: subject,
                    duration: timerSeconds,
                    date: new Date().toISOString()
                };
                data.studySessions.push(session);
                saveData();
                updateStudyLog();
                updateDashboard();
                updateMonthlyOverview();
            }
            pauseTimer();
            timerSeconds = 0;
            updateTimerDisplay();
            document.getElementById('startBtn').disabled = false;
        }

        function updateTimerDisplay() {
            const hours = Math.floor(timerSeconds / 3600);
            const minutes = Math.floor((timerSeconds % 3600) / 60);
            const seconds = timerSeconds % 60;
            document.getElementById('timerDisplay').textContent = 
                `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        function addSubject() {
            const newSubject = document.getElementById('newSubject').value.trim();
            if (newSubject && !data.subjects.includes(newSubject)) {
                data.subjects.push(newSubject);
                saveData();
                updateSubjectSelect();
                document.getElementById('newSubject').value = '';
            }
        }

        function updateSubjectSelect() {
            const select = document.getElementById('subjectSelect');
            const editSelect = document.getElementById('editSubject');
            select.innerHTML = '<option value="">Select Subject</option>';
            editSelect.innerHTML = '';
            
            data.subjects.forEach(subject => {
                const option = document.createElement('option');
                option.value = subject;
                option.textContent = subject;
                select.appendChild(option);
                editSelect.appendChild(option.cloneNode(true));
            });
        }

        function updateStudyLog() {
            const today = new Date().toDateString();
            const todaySessions = data.studySessions.filter(s => 
                new Date(s.date).toDateString() === today
            );
            
            const logDiv = document.getElementById('studyLog');
            logDiv.innerHTML = '';
            
            if (todaySessions.length === 0) {
                logDiv.innerHTML = '<p style="color: #999; text-align: center; padding: 20px;">No study sessions recorded today. Start your timer!</p>';
            } else {
                todaySessions.forEach((session, localIndex) => {
                    const actualIndex = data.studySessions.indexOf(session);
                    const div = document.createElement('div');
                    div.className = 'study-log';
                    const hours = Math.floor(session.duration / 3600);
                    const minutes = Math.floor((session.duration % 3600) / 60);
                    const time = new Date(session.date).toLocaleTimeString();
                    div.innerHTML = `
                        <div>
                            <strong>${session.subject}</strong>: ${hours}h ${minutes}m
                            <span style="color: #999; margin-left: 15px;">${time}</span>
                        </div>
                        <div>
                            <button class="edit-btn" onclick="editSession(${actualIndex})">‚úèÔ∏è Edit</button>
                            <button class="delete-btn" onclick="deleteSession(${actualIndex})">üóëÔ∏è Delete</button>
                        </div>
                    `;
                    logDiv.appendChild(div);
                });
            }

            const totalsDiv = document.getElementById('subjectTotals');
            totalsDiv.innerHTML = '';
            const subjectTotals = {};
            
            data.studySessions.forEach(session => {
                if (!subjectTotals[session.subject]) {
                    subjectTotals[session.subject] = 0
